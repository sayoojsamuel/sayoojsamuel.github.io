<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Cool New Hexo</title>
      <link href="/2018/10/28/Site-Updated/"/>
      <url>/2018/10/28/Site-Updated/</url>
      <content type="html"><![CDATA[<p>Wow, This looks cool! </p><p>Let me tell you a fact, that Hexo is totally cool! To start with, I’m writing my blog with the <strong>Hexo Admin</strong> plugin. This blog is build with cool new features, far more than I can list out here. </p><p>Guys, this will be the beginning of series of blog posts to handle Hexo Blogging. Not much to say right now. Till next time, Adios!</p>]]></content>
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Tile-Mate</title>
      <link href="/2018/10/26/tile-mate/"/>
      <url>/2018/10/26/tile-mate/</url>
      <content type="html"><![CDATA[<p>Writeup from Bsides CTF’18</p><h1 id="Bsides-CTF-2018-Tile-Mate"><a href="#Bsides-CTF-2018-Tile-Mate" class="headerlink" title="Bsides CTF 2018: Tile Mate"></a>Bsides CTF 2018: Tile Mate</h1><p><strong>Category:</strong> Crypto<br><strong>Challenge Points:</strong> 100<br><strong>Solves:</strong> 35<br><strong>Description:</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">David and Toni rides scooter. Everyone knows except them!</span><br></pre></td></tr></table></figure></p><p><strong>Attachments:</strong> tile_mate.tar.xz</p><p>This is an easy <code>XOR</code> challenge, with a custom plaintext substitution before the actual <code>XOR</code> process.<br>Again, the attachment contains two files</p><ol><li>encrypt.py</li><li>ci.pher.text</li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> cycle <span class="keyword">as</span> scooter</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG, KEY</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha384</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> FLAG.islower()</span><br><span class="line"><span class="keyword">assert</span> len(KEY) == <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">drive</span><span class="params">(Helmet, Petrol)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(chr(ord(David)^ord(Toni)) <span class="keyword">for</span> David,Toni <span class="keyword">in</span> zip(Helmet,scooter(Petrol)))</span><br><span class="line">f = <span class="keyword">lambda</span> x: sha384(x).digest()[(ord(x)+<span class="number">7</span>)%<span class="number">48</span>]</span><br><span class="line">encrypted = drive(map(f,FLAG),KEY.decode(<span class="string">'hex'</span>)).encode(<span class="string">'hex'</span>)</span><br><span class="line">open(<span class="string">'ci.pher.text'</span>,<span class="string">'wb'</span>).write(encrypted)</span><br></pre></td></tr></table></figure><p>Hmm, it is pretty obvious <code>drive()</code> is the <strong>Repeated Key <code>XOR</code></strong> function, although the function looks cool! (Atleast the ‘Helmet,scooter(Petrol)’ part :p)..<br><code>f</code> being another function which returns the <code>x+7</code>th index character from the sha384 hash of <code>x</code>.<br>The ciphertext is simply the XOR(f(pt),key).</p><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span> FLAG.islower()</span><br><span class="line"><span class="keyword">assert</span> len(KEY) == <span class="number">10</span></span><br></pre></td></tr></table></figure><p>This suggests that the <strong>flag</strong> is composed of lowercase characters (digits and punctuation included) and the <strong>key</strong> length is 5 bytes (hex 10). </p><h4 id="Key-Recovery"><a href="#Key-Recovery" class="headerlink" title="Key Recovery"></a>Key Recovery</h4><p>Since the flag format is <code>flag{</code>, we can recover the <strong>key</strong> by XORing f(“<code>flag{</code>“) with <code>ciphertext</code>.<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">hashed_flag = <span class="string">''</span>.join(map(f,<span class="string">"flag&#123;"</span>))</span><br><span class="line">key = xor(hashed_flag,ct)</span><br><span class="line">hashed_pt = xor(ct,key)</span><br></pre></td></tr></table></figure></p><p>Now this <code>hashed_pt</code> is nothing but the hash of the <code>flag</code>.</p><h4 id="Getting-to-the-Flag"><a href="#Getting-to-the-Flag" class="headerlink" title="Getting to the Flag"></a>Getting to the Flag</h4><figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line">f = lambda <span class="keyword">x</span>: sha<span class="number">384</span>(<span class="keyword">x</span>).digest()[(<span class="keyword">ord</span>(<span class="keyword">x</span>)+<span class="number">7</span>)<span class="symbol">%48</span>]</span><br></pre></td></tr></table></figure><p>This custom hash is not reversible, but we can still create a map with all possible characters, cause that’s just 90 possibilities ( Remember the lowercase?)<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">chars = string.ascii_lowercase+string.digits+string.punctuation</span><br><span class="line">table = dict(zip(map(f,chars),chars))</span><br><span class="line"></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> hashed_pt: flag+=table[i]</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure></p><p>The <code>table</code> contains the dict of hash, and character as key, value pair.<br>For characters in <code>hashed_pt</code>, we find the preimage of the hash from the table. And you hold the flag for the challenge, TADA!!!</p><h2 id="Complete-Script"><a href="#Complete-Script" class="headerlink" title="Complete Script"></a>Complete Script</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha384</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> cycle</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(msg,key)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(chr(ord(i)^ord(j)) <span class="keyword">for</span> i,j <span class="keyword">in</span> zip(msg,cycle(key)))</span><br><span class="line"></span><br><span class="line">f = <span class="keyword">lambda</span> x: sha384(x).digest()[(ord(x)+<span class="number">7</span>)%<span class="number">48</span>]</span><br><span class="line">ct = open(<span class="string">'ci.pher.text'</span>,<span class="string">'rb'</span>).read().decode(<span class="string">'hex'</span>)</span><br><span class="line">hashed_flag = <span class="string">''</span>.join(map(f,<span class="string">"flag&#123;"</span>))</span><br><span class="line">key = xor(hashed_flag,ct)</span><br><span class="line">hashed_pt = xor(ct,key)</span><br><span class="line"></span><br><span class="line">chars = string.ascii_lowercase+string.digits+string.punctuation</span><br><span class="line">table = dict(zip(map(f,chars),chars))</span><br><span class="line"></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> hashed_pt: flag+=table[i]</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p><strong>flag{cr1b_dr4g_w1th_u1tr4_c00l_sc00ter!}</strong></p><h3 id="Author’s-Note"><a href="#Author’s-Note" class="headerlink" title="Author’s Note"></a>Author’s Note</h3><p>Okay, this is the second challenge I authored for BSides CTF’18 being organised at Delhi, the first one being <a href="https://sayoojsamuel.github.io/2018/10/26/pyQueue/">pyQueue</a>.</p><h2 id="4-Line-exploit"><a href="#4-Line-exploit" class="headerlink" title="4 Line exploit"></a>4 Line exploit</h2><p>Just a show-off,<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha384;<span class="keyword">from</span> itertools <span class="keyword">import</span> cycle;<span class="keyword">import</span> string</span><br><span class="line">xor,f,ct,chars=<span class="keyword">lambda</span> (msg,key): <span class="string">''</span>.join(chr(ord(i)^ord(j)) <span class="keyword">for</span> i,j <span class="keyword">in</span> zip(msg,cycle(key))),<span class="keyword">lambda</span> x: sha384(x).digest()[(ord(x)+<span class="number">7</span>)%<span class="number">48</span>],open(<span class="string">'ci.pher.text'</span>,<span class="string">'rb'</span>).read().decode(<span class="string">'hex'</span>),string.ascii_lowercase+string.digits+string.punctuation</span><br><span class="line">hashed_pt,flag,table=xor((ct,xor((<span class="string">''</span>.join(map(f,<span class="string">"flag&#123;"</span>)),ct)))),<span class="string">""</span>,dict(zip(map(f,chars),chars))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> hashed_pt: flag+=table[i];<span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XOR, Python, Custom, Hash, Delhi, , Bsides, CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>pyQueue</title>
      <link href="/2018/10/26/pyQueue/"/>
      <url>/2018/10/26/pyQueue/</url>
      <content type="html"><![CDATA[<p>Writeup from Bsides CTF’18</p><h1 id="Bsides-CTF-2018-pyQueue"><a href="#Bsides-CTF-2018-pyQueue" class="headerlink" title="Bsides CTF 2018: pyQueue"></a>Bsides CTF 2018: pyQueue</h1><p><strong>Category:</strong> Crypto<br><strong>Challenge Points:</strong> 150<br><strong>Solves:</strong> 43<br><strong>Description:</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Easy Right?</span><br></pre></td></tr></table></figure></p><p><strong>Attachments:</strong> pyQueue.tar.xz</p><p>The attachment contains two files</p><ol><li>encrypt.py</li><li>ci.pher.text</li></ol><p>Let’s analyse the <code>encrypt.py</code><br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">key = AES_Key()</span><br><span class="line">ct=<span class="string">""</span></span><br><span class="line">MAC = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> List <span class="keyword">in</span> slice(FLAG):</span><br><span class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> List:</span><br><span class="line">        cipher = AES.new(key.shuffle(), AES.MODE_ECB)</span><br><span class="line">        ct+= cipher.encrypt(block)</span><br><span class="line">        MAC ^= int(ct[<span class="number">-16</span>:].encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">MAC ^= int(key.shuffle().encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">open(<span class="string">"ci.pher.text"</span>,<span class="string">'wb'</span>).write(str(MAC) +<span class="string">":"</span>+ ct.encode(<span class="string">'hex'</span>))</span><br></pre></td></tr></table></figure></p><p>Well, it’s an AES challenge on first sight. Three points to note, </p><ol><li>Each time an AES instance is created, a new <strong>key</strong> is being used as a resultant of <code>key.shuffle()</code></li><li><p><strong>MAC</strong> is generated as the <code>XOR</code> of all the <code>ct</code> blocks. At the end, <strong>MAC</strong> is xored with <strong>key</strong> after being shuffled for one last time.</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">MAC ^= int(key.shuffle().encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br></pre></td></tr></table></figure></li><li><p><strong>ci.pher.text</strong> is of the format <em>MAC:CipherText</em> </p></li></ol><p>A peek into the Key generation,<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AES_Key</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.key=list(os.urandom(<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">enqueue</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.key+=get_random_bytes(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dequeue</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.key=self.key[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">size</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> len(self.key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">shuffle</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.dequeue()</span><br><span class="line">        self.enqueue()</span><br><span class="line">        <span class="keyword">assert</span> self.size()==AES.block_size</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>.join(self.key)</span><br></pre></td></tr></table></figure></p><p>This reveals that <code>shuffle()</code> method just removes the first byte of the 16 byte <strong>key</strong> and appends a random byte at the end. The complete setup was implemented as a Queue :P. This makes it a whole lot easier to bruteforce!</p><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h4 id="Key-Recovery"><a href="#Key-Recovery" class="headerlink" title="Key Recovery"></a>Key Recovery</h4><p>Now, to recover the <strong>key</strong>, we just have to <code>XOR</code> the <strong>MAC</strong> with all the <code>ct</code> blocks. The resultant is the key.shuffled() value.<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Calculate key</span></span><br><span class="line">last_key = int(MAC)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ct:</span><br><span class="line">    last_key ^= int(i.encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line">last_key = long_to_bytes(last_key)</span><br></pre></td></tr></table></figure></p><h4 id="BruteForce"><a href="#BruteForce" class="headerlink" title="BruteForce"></a>BruteForce</h4><p>All you need to do now is to bruteforce over 256 possible character. That is, remove the last byte of <code>assumed key</code> and add the bruteforce character at the beginning. The <strong>key</strong> pair for the <code>plaintext</code> where most of the starting characters are printable is what we are looking for.<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brute</span><span class="params">()</span>:</span></span><br><span class="line">    key = last_key</span><br><span class="line">    pt = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">        key = key[:<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">for</span> ch <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            cipher = AES.new(chr(ch)+key,AES.MODE_ECB)</span><br><span class="line">            recover = cipher.decrypt(ct[i])</span><br><span class="line">            <span class="keyword">if</span>(all(c <span class="keyword">in</span> printable <span class="keyword">for</span> c <span class="keyword">in</span> recover[:<span class="number">10</span>])):</span><br><span class="line">                pt = recover + pt</span><br><span class="line">                key = chr(ch)+key</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> pt</span><br></pre></td></tr></table></figure></p><h2 id="Complete-Script"><a href="#Complete-Script" class="headerlink" title="Complete Script"></a>Complete Script</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split_by</span><span class="params">(msg,step)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [msg[i:i+step] <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(msg),<span class="number">16</span>)]</span><br><span class="line"></span><br><span class="line">data = open(<span class="string">"ci.pher.text"</span>,<span class="string">'rb'</span>).read()</span><br><span class="line">MAC,ct = data.split(<span class="string">":"</span>)</span><br><span class="line"></span><br><span class="line">ct = split_by(ct.decode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate key</span></span><br><span class="line">last_key = int(MAC)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ct:</span><br><span class="line">    last_key ^= int(i.encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line">last_key = long_to_bytes(last_key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Brute Joy!!!</span></span><br><span class="line">key = last_key</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brute</span><span class="params">()</span>:</span></span><br><span class="line">    key = last_key</span><br><span class="line">    pt = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,<span class="number">-1</span>,<span class="number">-1</span>):</span><br><span class="line">        key = key[:<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">for</span> ch <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">            cipher = AES.new(chr(ch)+key,AES.MODE_ECB)</span><br><span class="line">            recover = cipher.decrypt(ct[i])</span><br><span class="line">            <span class="keyword">if</span>(all(c <span class="keyword">in</span> printable <span class="keyword">for</span> c <span class="keyword">in</span> recover[:<span class="number">10</span>])):</span><br><span class="line">                pt = recover + pt</span><br><span class="line">                key = chr(ch)+key</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> pt</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> brute()</span><br></pre></td></tr></table></figure><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p><strong>flag{H4il_bUggi3s!_qu3u3_k3y_2_h0t_4_w4rmUp}</strong></p><h3 id="Author’s-Note"><a href="#Author’s-Note" class="headerlink" title="Author’s Note"></a>Author’s Note</h3><p>I authored this challenge for Bsides CTF’18. I know that these kinda bruteforce challenges makes it hard for pro’s to play with, but will be pretty interesting for the beginners. I’m just saying :p<br>Also, check out the writeup of <a href="https://sayoojsamuel.github.io/2018/10/26/tile-mate/">Tile-Mate</a> (Crypto 100) challenge here.</p>]]></content>
      
      <categories>
          
          <category> Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Bruteforce, Python, Queue, AES, ECB, Bsides, CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Big Boss Winner</title>
      <link href="/2018/09/30/bigboss/"/>
      <url>/2018/09/30/bigboss/</url>
      <content type="html"><![CDATA[<p>!!! note: This article is just for Live Analytics, So..<br>Big Boss Malayalam Winner Leaked!</p><h1 id="Big-Boss-Malayalam-Winner-Season1"><a href="#Big-Boss-Malayalam-Winner-Season1" class="headerlink" title="Big Boss Malayalam Winner Season1"></a>Big Boss Malayalam Winner Season1</h1><h2 id="Pearle-Maaney-Bags-the-Title"><a href="#Pearle-Maaney-Bags-the-Title" class="headerlink" title="Pearle Maaney Bags the Title"></a>Pearle Maaney Bags the Title</h2><p><img src="/images/Pearley-Maaney.jpg" alt="Pearley Maaney Winner"><br>Yeah, that shocking. But the Winner of BigBoss Season 1 Malayalam Edition is the most charming <strong>Pearle Maaney</strong>!! This result was declared based on the Users vote and other competition criterias. However, the winner will be declared only at the event finals to be held today. She will be awarded a price worth 1 Crore Rupees (US$140,000). This update is live and based on trusted sources. The Grand Finale will be a must watch show for all the followers of the most addictive<br>Television Show Premier. Follow for more updated on BigBoss Malayalam Spoilers. </p><h2 id="The-Finals"><a href="#The-Finals" class="headerlink" title="The Finals"></a>The Finals</h2><p>The Finals for the event will be aired at Asianet at 7 pm (August 30, 2018). This is the most awaited moment for the finalists as well as the audience. Pearle Maaney,    Sabumon Abdusamad, Srinish Aravind, Aristo Suresh and Shiyas Kareem were the finalists as the show moved to a close.  The finals is ment to be a grand suprise.</p><p>As the Leak suggests, Aristo Suresh and Srinish Aravind will be evicted at the begining. However, the final duo will be Pearley and Sabumon, as Shiyas Kareem will be evicted right after Srinish.  The glorious race to the Title will be taken by Pearley Maaney right after a thrilling Finale with Sabumon. </p><h2 id="Big-Boss-Location-Revealed"><a href="#Big-Boss-Location-Revealed" class="headerlink" title="Big Boss Location Revealed!"></a>Big Boss Location Revealed!</h2><p>Bigg Boss Malayalam 1 is the first season of Malayalam language version of the reality TV show Bigg Boss broadcast in India. The show premiered on June 24, 2018 on Asianet. Veteran actor Mohanlal is the host of the show. For the first season, a splendid home had set up in <strong>Lonavala</strong>.</p><p>The First Episode started on June 24 2018. The audience vote is the only criteria for the eviction as suggested by sources. But recent doubts have erupted as the Vote statistics is not made public. </p><h2 id="Season-2"><a href="#Season-2" class="headerlink" title="Season 2"></a>Season 2</h2><p>The wait for the Season 2 is now up, as users already started a buzz on social media for the same.</p>]]></content>
      
      <categories>
          
          <category> Entertainment </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BigBoss, Big Boss, Grand Finale, Season 1, Leak, Spoiler, </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Flatcrypto</title>
      <link href="/2018/09/16/flatcrypto/"/>
      <url>/2018/09/16/flatcrypto/</url>
      <content type="html"><![CDATA[<p>Writeup from CSAW QUALS CTF’18</p><h1 id="CSAW-CTF-QUALS-2018-Flatcrypto"><a href="#CSAW-CTF-QUALS-2018-Flatcrypto" class="headerlink" title="CSAW CTF QUALS 2018: Flatcrypto"></a>CSAW CTF QUALS 2018: Flatcrypto</h1><p><strong>Category:</strong> Crypto<br><strong>Challenge Points:</strong> 100<br><strong>Solves:</strong> 184<br><strong>Description:</strong><br><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">no logos or branding <span class="keyword">for</span> this bug</span><br><span class="line"></span><br><span class="line">Take your pick nc crypto<span class="selector-class">.chal</span><span class="selector-class">.csaw</span><span class="selector-class">.io</span> <span class="number">8040</span> nc crypto<span class="selector-class">.chal</span><span class="selector-class">.csaw</span><span class="selector-class">.io</span> <span class="number">8041</span> nc crypto<span class="selector-class">.chal</span><span class="selector-class">.csaw</span><span class="selector-class">.io</span> <span class="number">8042</span> nc crypto<span class="selector-class">.chal</span><span class="selector-class">.csaw</span><span class="selector-class">.io</span> <span class="number">8043</span></span><br><span class="line"></span><br><span class="line">flag is not <span class="keyword">in</span> flag format. flag is PROBLEM_KEY</span><br></pre></td></tr></table></figure></p><p><strong>Attachments:</strong> serv-distribute.py<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line">ENCRYPT_KEY = bytes.fromhex(<span class="string">'0000000000000000000000000000000000000000000000000000000000000000'</span>)</span><br><span class="line"><span class="comment"># Determine this key.</span></span><br><span class="line"><span class="comment"># Character set: lowercase letters and underscore</span></span><br><span class="line">PROBLEM_KEY = <span class="string">'not_the_flag'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(data, ctr)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> AES.new(ENCRYPT_KEY, AES.MODE_CTR, counter=ctr).encrypt(zlib.compress(data))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        f = input(<span class="string">"Encrypting service\n"</span>)</span><br><span class="line">        <span class="keyword">if</span> len(f) &lt; <span class="number">20</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        enc = encrypt(bytes((PROBLEM_KEY + f).encode(<span class="string">'utf-8'</span>)), Counter.new(<span class="number">64</span>, prefix=os.urandom(<span class="number">8</span>)))</span><br><span class="line">        print(<span class="string">"%s%s"</span> %(enc, chr(len(enc))))</span><br></pre></td></tr></table></figure></p><p>Again, it’s another sipmple challenge based on AES_CTR.  For all those noobies, note that AES Counter mode does not have <strong><code>Padding</code></strong>.  And this challenge is specifically based on that. If we have a close look, it is the PROBLEM_KEY which we need to figure out. Now see that,<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">enc = encrypt(bytes((PROBLEM_KEY + f).encode(<span class="string">'utf-8'</span>)),    |Counter.new(<span class="number">64</span>, prefix=os.urandom(<span class="number">8</span>)))</span><br></pre></td></tr></table></figure></p><p>is where we target out exploit.  Our input <code>f</code> is appended to the PROBLEM_KEY, compressed and then encrypted without padding.   This zlib compression is a huge vuln, and we forge a custom input such that the plaintext is compressed before encryption. Thus, it results in reduced length of the ciphertext.</p><p>It is mentioned that the character set is lowercase ascii and underscore.<br>I have created a bruteforce script, in which, the brute starts with character ‘a’ till ‘z’ multiplied 20 times.<br>The length of the ciphertext decreases when the <strong>brute_char</strong> matches with the <strong>last byte</strong> of the PRODUCT_KEY. For the second last byte, we repeat the <strong>brute_char+lastbyte</strong> 20 times. Similarly the third last byte, which follows as<br><strong>brute_char+secondlast+lastbyte</strong> 20 times.</p><p>This will eventually give us the flag, which is not in the flag format.</p><h2 id="Complete-Script"><a href="#Complete-Script" class="headerlink" title="Complete Script"></a>Complete Script</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">"error"</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">chars = string.ascii_lowercase + <span class="string">"_"</span></span><br><span class="line">flag = <span class="string">""</span>    </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">30</span>):</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"flag:"</span>,flag</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> chars:</span><br><span class="line">        io = remote(<span class="string">"crypto.chal.csaw.io"</span>,<span class="number">8040</span>)</span><br><span class="line">        <span class="keyword">print</span> io.recv()</span><br><span class="line">        io.sendline((i+flag)*<span class="number">20</span>)</span><br><span class="line">        <span class="keyword">print</span> (i+flag)</span><br><span class="line">        out = io.recvline()</span><br><span class="line">        l = ord(out[<span class="number">-2</span>])</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"len="</span>,l, i</span><br><span class="line">        <span class="keyword">if</span> l&lt;<span class="number">35</span>:                  <span class="comment">#&lt;== You have to edit this manually</span></span><br><span class="line">            <span class="keyword">print</span> i</span><br><span class="line">            flag=i+flag</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        io.close()</span><br></pre></td></tr></table></figure><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p><strong>crime_doesnt_have_a_logo</strong></p><h3 id="Plaid-CTF-Compression"><a href="#Plaid-CTF-Compression" class="headerlink" title="Plaid CTF Compression"></a>Plaid CTF Compression</h3><p>A note to all the readers, that this challenge was the exact copy of the 2013 Plaid CTF challenge - Compression.  Dosen’t know why they have to give the exact same question.  Follow the writeup for the challenge for detailed explanation.</p>]]></content>
      
      <categories>
          
          <category> Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zlib, compression, CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Babycrypto</title>
      <link href="/2018/09/16/babycrypto/"/>
      <url>/2018/09/16/babycrypto/</url>
      <content type="html"><![CDATA[<p>Writeup from CSAW QUALS CTF’18</p><h1 id="CSAW-CTF-QUALS-2018-Babycrypto"><a href="#CSAW-CTF-QUALS-2018-Babycrypto" class="headerlink" title="CSAW CTF QUALS 2018: Babycrypto"></a>CSAW CTF QUALS 2018: Babycrypto</h1><p><strong>Category:</strong> Crypto<br><strong>Challenge Points:</strong> 50<br><strong>Solves:</strong> 295<br><strong>Description:</strong><br><figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">yeeeeeeeeeeeeeeeeeeeeeeeeeeeeeet</span><br><span class="line"></span><br><span class="line"><span class="built_in">single</span> yeet yeeted <span class="keyword">with</span> <span class="built_in">single</span> yeet == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">yeeet</span><br><span class="line"></span><br><span class="line">what <span class="keyword">is</span> yeet?</span><br><span class="line"></span><br><span class="line">yeet <span class="keyword">is</span> yeet</span><br></pre></td></tr></table></figure></p><p><strong>Attachments:</strong> ciphertext.txt<br><code>PRO TIP</code>:Tell you what, the smallest crypto will always be XOR in CSAW!  And <code>a XOR a == 0</code> ==&gt;<br><figure class="highlight vbnet"><table><tr><td class="code"><pre><span class="line">|<span class="built_in">single</span> yeet yeeted <span class="keyword">with</span> <span class="built_in">single</span> yeet == <span class="number">0</span></span><br></pre></td></tr></table></figure></p><p>And that’s the hint! to suggest it is a XOR challenge. So, we start with the attachment file, which includes a <code>base64</code> encoded ciphertext.<br>Perform a single byte xor, and you’ll find the flag in character 255.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Leon is a programmer who aspires to create programs that <span class="built_in">help</span> people <span class="keyword">do</span> less. He wants to put automation first, and scalability alongside. He dreams of a world <span class="built_in">where</span> the endless and the infinite become realities to mankind, and <span class="built_in">where</span> the <span class="literal">true</span> value of life is preserved.flag&#123;diffie-hellman-g0ph3rzraOY1Jal4cHaFY9SWRyAQ6aH&#125;</span><br></pre></td></tr></table></figure><h2 id="Complete-Script"><a href="#Complete-Script" class="headerlink" title="Complete Script"></a>Complete Script</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> chr(ord(i)^ord(j) <span class="keyword">for</span> i,j <span class="keyword">in</span> zip(a,b))</span><br><span class="line"></span><br><span class="line">ct = open(<span class="string">'ciphertext.txt'</span>,<span class="string">'rb'</span>).read().decode(<span class="string">'base64'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line">    pt = xor(ct,chr(i)*len(ct))</span><br><span class="line">    <span class="keyword">if</span> all(c <span class="keyword">in</span> string.printable <span class="keyword">for</span> c <span class="keyword">in</span> pt): <span class="keyword">print</span> pt</span><br></pre></td></tr></table></figure><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p><strong>flag{diffie-hellman-g0ph3rzraOY1Jal4cHaFY9SWRyAQ6aH}</strong></p>]]></content>
      
      <categories>
          
          <category> Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Xor, yeet, , CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Marty0ska1</title>
      <link href="/2018/09/14/marty0ska1/"/>
      <url>/2018/09/14/marty0ska1/</url>
      <content type="html"><![CDATA[<p>Writeup from SEC-T CTF’18</p><h1 id="SEC-T-CTF-2018-Marty0ska1"><a href="#SEC-T-CTF-2018-Marty0ska1" class="headerlink" title="SEC-T CTF 2018: Marty0ska1"></a>SEC-T CTF 2018: Marty0ska1</h1><p><strong>Category:</strong> Crypto<br><strong>Challenge Points:</strong> 51<br><strong>Solves:</strong> 60+</p><p><strong>Service:</strong> nc crypto.sect.ctf.rocks 2222</p><p>Really bad they took down the website and services soon after the CTF, I coudn’t complete my write up. So as you read, don’t expect the flag, though the method remains the same.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc crypto.sect.ctf.rocks 2222</span><br></pre></td></tr></table></figure><p>As you are connected to the service, you are given three numbers: <code>p</code>, <code>g</code>, and <code>g^x</code>. They demand <code>x</code>.</p><h3 id="Discrete-Logarithmic-Problem"><a href="#Discrete-Logarithmic-Problem" class="headerlink" title="Discrete Logarithmic Problem"></a>Discrete Logarithmic Problem</h3><p>A stright DLP challenge. Things to notice, <code>g</code>=2, and <code>p</code> is <em>factorizable</em>.  Tada!! it is Pohlig-Hellman. Use a sage script to solve the challenge.<br>Let y=g^x</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">R = IntegerModRing(p)</span><br><span class="line">x = discrete_log(R(y), R(g))</span><br><span class="line">print x</span><br></pre></td></tr></table></figure><p>This will give the flag in less than two seconds. And that it.Submit x, to get the flag.</p><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p>**SECT{Ru$$ian_D0LLZ_h0lDs_TH3_S3cR3T}</p><h3 id="Further-Reading"><a href="#Further-Reading" class="headerlink" title="Further Reading"></a>Further Reading</h3><p>Tum CTF 2016 <a href="http://mslc.ctf.su/wp/tum-ctf-2016-tacos-crypto-300/" target="_blank" rel="noopener">tacos</a></p>]]></content>
      
      <categories>
          
          <category> Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crypto, DLP, Pohlig-Hellman Algorithm, CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Encoding</title>
      <link href="/2018/09/12/encoding/"/>
      <url>/2018/09/12/encoding/</url>
      <content type="html"><![CDATA[<p>The basics of Encoding, a Beginner’s guide</p><h1 id="Encoding"><a href="#Encoding" class="headerlink" title="Encoding"></a>Encoding</h1><h2 id="What-is-Encoding"><a href="#What-is-Encoding" class="headerlink" title="What is Encoding?"></a>What is Encoding?</h2><p>If we start explain it to a 10 year old, the definition would go like, “Encoding is the process of changing data representation”.<br>Rather, may be we should check this out :  <em>In computer technology, encoding is the process of applying a specific code, such as letters, symbols and numbers, to data for conversion into an equivalent cipher.</em><br>The most common example would be changing “abc” to “ABC”, the lower-to-upper encoding.</p><p>That was pretty basic! We also have a standard for converting characters.<br>American Standard Code for Information Interchange (ASCII) was introduced just for that.<br>Under ASCII, each character is given a unique decimal equivalent. That is, the character ‘A’ is given code 65, ‘B’ 66 and so on.<br>You can see the complete reference by typing the following in your linux terminal.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ man ascii</span><br></pre></td></tr></table></figure></p><p>Now, if you have done that, it’s now clear that ASCII contains printable and nonprintable characters that represent uppercase and lowercase letters, symbols, punctuation marks and numbers.<br>In <code>man ascii</code>, you must have noticed that there was a seperate tab called oct and hex. These are different number system, which we will be covering below.<br>So a string, “Hello” can be converted to ASCII as “72 101 108 108 111”. This is how computers process information.</p><h3 id="Number-System"><a href="#Number-System" class="headerlink" title="Number System"></a>Number System</h3><ul><li>Binary</li><li>Octal</li><li>Decimal</li><li>Hexadecimal</li></ul><p>Decimal is the number system used around the world. But if you peep into Mathematical Computing, we have many number systems.<br>The most prevalent is <strong>Binary</strong>, which uses just 1’s and 0’s to represent data [Thus it is a base 2 number system]. Next we have <strong>Octal</strong> number system with base 8. Here, we use 8 digits to represent data, from 0,1,2 to 7. We also have hexadecimal, another commonly used system. Hexadecimal in fact means a base of 16. Since we only have 10 digits, we also use characters from A to F. So hex characters include 1,2,..,9,A,B,C,D,E and F, making a total of 16 digits. It is possible to convert data from<br>one system to another, but that is beyond the scope of this tutorial.</p><h2 id="Hex-Encoding"><a href="#Hex-Encoding" class="headerlink" title="Hex Encoding"></a>Hex Encoding</h2><p>Hex encoding is the process of changing data into hexadecimal representation. Having said that, Hexadecimal numerals are widely used by computer system designers and programmers, as they provide a more human-friendly representation of binary values. You can also try converting decimals and Strings to hex.<br>Each hexadecimal character can be expanded into binary digits (A nibble). And it implies that a byte of data can be represented using two hex chars. Isn’t that cool?</p><p>!!!Note<br>In order to differentiate between the representations, we have different prefixes added to the data.<br><strong>\x</strong> or <strong>0x</strong> is the generally accepted prefix added to hexadecimal string.<br>!!!</p><h3 id="A-quick-Example"><a href="#A-quick-Example" class="headerlink" title="A quick Example:"></a>A quick Example:</h3><p>0000 of binary will convert to ‘0’ of hex. Similarly, ‘f’ of hex will be 1111 of binary.<br>Taking a byte at a time –&gt;<br><strong>0x00</strong> is <strong>0b00000000</strong>, <strong>0x01</strong> is <strong>0b00000001</strong>, and so and so forth till <strong>0x0f</strong> represents <strong>0b00001111</strong> (The Decimal equivalent is 15). When we move further, <strong>0x10</strong> is <strong>0b00010000</strong> (Decimal 16) till <strong>0xff</strong> which is <strong>0b11111111</strong> (Decimal 255).</p><h3 id="The-Encoding-part"><a href="#The-Encoding-part" class="headerlink" title="The Encoding part"></a>The Encoding part</h3><p>Recollect that each character is assigned a decimal equivalent in ASCII [from 0 to 255].<br>If we try to map it together, it turns out that each of the decimal equivalent can then be converted into hex.<br>That’s it! The character ‘<strong>A</strong>‘ has decimal value of <strong>65</strong>, which converts to <strong>0x41</strong> in hex.</p><p>So next time we say <strong>0x68656c6c6f</strong>, be sure to convert it into <strong>ASCII</strong>. If you are too lazy (its common among hackers,) it’s just “Hello” !</p><h2 id="Base64-Encoding"><a href="#Base64-Encoding" class="headerlink" title="Base64 Encoding"></a>Base64 Encoding</h2><p>As mentioned, Hex had only 16 characters. But this one is still awesome. Meet the Base64, with 64 characters. Base64 encoding takes three bytes, each consisting of 8 bits. The following is the character set for Base64  -</p><pre><code>1. [a-z]  -  26 characters2. [A-Z]  -  26 characters3. [0-9]  -  10 characters4. [+]    -  1 character5. [/]    -  1 character</code></pre><p>Now that if you count, it will add up to 64.  It also have ‘=’ character, which is solely used for padding purposes.<br>This character set includes uppercase and lowercase alphabets, digits, ‘+’ and ‘/‘. </p><h3 id="Encoding-1"><a href="#Encoding-1" class="headerlink" title="Encoding"></a>Encoding</h3><p>The process is really simple. Write down the binary of the message, taking groups of 6 in one block. Now compare each block with the binary or decimal value with the corresponding character in the Base64 Chart. Join the characters, and that it. You’re done! </p><h4 id="Padding"><a href="#Padding" class="headerlink" title="Padding"></a>Padding</h4><p>Always remember, your Base64 string length should be a multiple of 3. If not, you must add ‘=’ character at the end untill it’s a multiple. Padding is necessarity required for Base64 and it might save you from Padding errors.<br>Pro Tip: And if you happen to see ‘=’ at the end of the string, don’t hesitate, try a Base64 decode!</p><h2 id="Hands-On"><a href="#Hands-On" class="headerlink" title="Hands-On"></a>Hands-On</h2><p>So where do you start?  We’ll share you an ‘WOW, THAT’s AWESOME!’ tip.  Forget all that boring pen paper calculation you have to do!  If you have a python shell, just simply type:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">"your-string-here"</span>.encode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure></p><p>to print the Hex encoded string. To decode a hex string, just change it to<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">print</span> <span class="string">"some-hex-string"</span>.decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure></p><p>Similarly, you can do Base64 encoding with <code>.encode(&#39;base64&#39;)</code></p><p>It’s also fine if you’re comfortable using online tools for these. At times, even they come handly!</p>]]></content>
      
      <categories>
          
          <category> Article </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Encoding, CTF, Hex, Base64, Python </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Chop Suey</title>
      <link href="/2018/09/09/chopsuey/"/>
      <url>/2018/09/09/chopsuey/</url>
      <content type="html"><![CDATA[<p>Writeup from noxCTF’18</p><h1 id="noxCTF-2018-Chop-Suey"><a href="#noxCTF-2018-Chop-Suey" class="headerlink" title="noxCTF 2018: Chop-Suey"></a>noxCTF 2018: Chop-Suey</h1><p><strong>Category:</strong> Crypto<br><strong>Challenge Points:</strong> 118<br><strong>Solves:</strong> 235<br><strong>Description:</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Today I ate <span class="keyword">in</span> a Chinese restaurant and got myself a fortune cookie. These things usually contain a note with a nice sentence or phrase, but mine had numbers <span class="keyword">in</span> it instead! Can you <span class="built_in">help</span> me find the meaning of the numbers?</span><br><span class="line"></span><br><span class="line">p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229 </span><br><span class="line">q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469 </span><br><span class="line">dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929 </span><br><span class="line">dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041 </span><br><span class="line">c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span><br></pre></td></tr></table></figure></p><p>So if you have learned Chinese Remainder Theorem, you would definitely have known this optimisation technique for RSA.<br>It states:<br><code>dp = d (mod p-1)</code><br><code>dq = d (mod q-1)</code><br>This technique is more faster than the Textbook RSA and with out <strong>p</strong> and <strong>q</strong>, you’d be having a really tough time. Just take a glimpse into what <a href="https://en.wikipedia.org/wiki/RSA_\(cryptosystem\" target="_blank" rel="noopener">Wiki</a>#Using_the_Chinese_remainder_algorithm) has to say.<br>But for the funny part, they have already provided us with p and q values! We can easily recompute <code>qinv</code>, to get the flag.</p><h3 id="To-construct-qinv"><a href="#To-construct-qinv" class="headerlink" title="To construct qinv,"></a>To construct <strong>qinv</strong>,</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">qinv = modinv(q, p)</span><br><span class="line">m2 = pow(c, dq, q)</span><br><span class="line">m1 = pow(c, dp, p)</span><br><span class="line">h = (qinv * (m1 - m2)) % p</span><br><span class="line">m = m2 + h * q</span><br></pre></td></tr></table></figure><h3 id="The-complete-script"><a href="#The-complete-script" class="headerlink" title="The complete script:"></a>The complete script:</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=<span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span></span><br><span class="line"></span><br><span class="line">q=<span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span></span><br><span class="line"></span><br><span class="line">dp=<span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span></span><br><span class="line"></span><br><span class="line">dq=<span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span></span><br><span class="line"></span><br><span class="line">c=<span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">'modular inverse does not exist'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">qinv = modinv(q, p)</span><br><span class="line">m2 = pow(c, dq, q)</span><br><span class="line">m1 = pow(c, dp, p)</span><br><span class="line">h = (qinv * (m1 - m2)) % p</span><br><span class="line">m = m2 + h * q</span><br><span class="line">print(m)</span><br><span class="line"></span><br><span class="line">txt = hex(m)[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">print</span> <span class="string">''</span>.join([chr(int(<span class="string">''</span>.join(c), <span class="number">16</span>)) <span class="keyword">for</span> c <span class="keyword">in</span> zip(txt[<span class="number">0</span>::<span class="number">2</span>],txt[<span class="number">1</span>::<span class="number">2</span>])])</span><br></pre></td></tr></table></figure><h2 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h2><p><strong>noxCTF{W31c0m3_70_Ch1n470wn}</strong></p>]]></content>
      
      <categories>
          
          <category> Writeups </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Crypto, RSA </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Principium</title>
      <link href="/2018/08/26/Principium/"/>
      <url>/2018/08/26/Principium/</url>
      <content type="html"><![CDATA[<p>Welcome to my first Post!</p><h2 id="This-is-totally-crazy"><a href="#This-is-totally-crazy" class="headerlink" title="This is totally crazy"></a>This is totally crazy</h2><pre><code>&apos;&apos;&apos;bash    sudo kill -me&apos;&apos;&apos;</code></pre><h2 id="OK-See-the-wonders-at"><a href="#OK-See-the-wonders-at" class="headerlink" title="OK - See the wonders at"></a>OK - See the wonders at</h2><p>See more at: [Sayooj Samuel] (sayoojsamuel.github.io)</p>]]></content>
      
      
    </entry>
    
  
  
    
    <entry>
      <title>About</title>
      <link href="/about/index.html"/>
      <url>/about/index.html</url>
      <content type="html"><![CDATA[<h1 id="About-OneDark"><a href="#About-OneDark" class="headerlink" title="About OneDark"></a>About OneDark</h1><p>One Dark is my Personal Blog, a platform to showcase my interests and express my brain out.<br>Myself Sayooj Samuel, a 2nd year Computer Science Undergraduate, at Amrita Unversity, Amritapuri.  My brain is totally devoted to my wierd ideas.  </p><p>My Blog will be covering concepts and writeups about Cryptography challenges from CTF’s, that one being my favorite since the idea of Cyber Security crawled my thoughts.</p>]]></content>
    </entry>
    
    <entry>
      <title>Links</title>
      <link href="/links/index.html"/>
      <url>/links/index.html</url>
      <content type="html"><![CDATA[<h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2>]]></content>
    </entry>
    
  
</search>
